!function(q){function m(){this._events={};this._conf&&p.call(this,this._conf)}function p(a){a&&(this._conf=a,a.delimiter&&(this.delimiter=a.delimiter),a.maxListeners&&(this._events.maxListeners=a.maxListeners),a.wildcard&&(this.wildcard=a.wildcard),a.newListener&&(this.newListener=a.newListener),this.wildcard&&(this.listenerTree={}))}function g(a){this._events={};this.newListener=!1;p.call(this,a)}function k(a,d,b,c){if(!b)return[];var e=[],f,g,h,l;h=d.length;l=d[c];var m=d[c+1];if(c===h&&b._listeners){if("function"===
typeof b._listeners)a&&a.push(b._listeners);else for(d=0,c=b._listeners.length;d<c;d++)a&&a.push(b._listeners[d]);return[b]}if("*"===l||"**"===l||b[l]){if("*"===l){for(f in b)"_listeners"!==f&&b.hasOwnProperty(f)&&(e=e.concat(k(a,d,b[f],c+1)));return e}if("**"===l){(l=c+1===h||c+2===h&&"*"===m)&&b._listeners&&(e=e.concat(k(a,d,b,h)));for(f in b)"_listeners"!==f&&b.hasOwnProperty(f)&&("*"===f||"**"===f?(b[f]._listeners&&!l&&(e=e.concat(k(a,d,b[f],h))),e=e.concat(k(a,d,b[f],c))):e=f===m?e.concat(k(a,
d,b[f],c+2)):e.concat(k(a,d,b[f],c)));return e}e=e.concat(k(a,d,b[l],c+1))}(g=b["*"])&&k(a,d,g,c+1);if(b=b["**"])if(c<h)for(f in b._listeners&&k(a,d,b,h),b)"_listeners"!==f&&b.hasOwnProperty(f)&&(f===m?k(a,d,b[f],c+2):f===l?k(a,d,b[f],c+1):(h={},h[f]=b[f],k(a,d,{"**":h},c+1)));else b._listeners?k(a,d,b,h):b["*"]&&b["*"]._listeners&&k(a,d,b["*"],h);return e}var n=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)};g.prototype.delimiter=".";g.prototype.setMaxListeners=
function(a){this._events||m.call(this);this._events.maxListeners=a;this._conf||(this._conf={});this._conf.maxListeners=a};g.prototype.event="";g.prototype.once=function(a,d){this.many(a,1,d);return this};g.prototype.many=function(a,d,b){function c(){0===--d&&e.off(a,c);b.apply(this,arguments)}var e=this;if("function"!==typeof b)throw Error("many only accepts instances of Function");c._origin=b;this.on(a,c);return e};g.prototype.emit=function(){this._events||m.call(this);var a=arguments[0];if("newListener"===
a&&!this.newListener&&!this._events.newListener)return!1;if(this._all){for(var d=arguments.length,b=Array(d-1),c=1;c<d;c++)b[c-1]=arguments[c];c=0;for(d=this._all.length;c<d;c++)this.event=a,this._all[c].apply(this,b)}if("error"===a&&!(this._all||this._events.error||this.wildcard&&this.listenerTree.error)){if(arguments[1]instanceof Error)throw arguments[1];throw Error("Uncaught, unspecified 'error' event.");}var e;this.wildcard?(e=[],d="string"===typeof a?a.split(this.delimiter):a.slice(),k.call(this,
e,d,this.listenerTree,0)):e=this._events[a];if("function"===typeof e){this.event=a;if(1===arguments.length)e.call(this);else if(1<arguments.length)switch(arguments.length){case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:d=arguments.length;b=Array(d-1);for(c=1;c<d;c++)b[c-1]=arguments[c];e.apply(this,b)}return!0}if(e){d=arguments.length;b=Array(d-1);for(c=1;c<d;c++)b[c-1]=arguments[c];e=e.slice();c=0;for(d=e.length;c<d;c++)this.event=a,e[c].apply(this,
b);return 0<e.length||!!this._all}return!!this._all};g.prototype.on=function(a,d){if("function"===typeof a)return this.onAny(a),this;if("function"!==typeof d)throw Error("on only accepts instances of Function");this._events||m.call(this);this.emit("newListener",a,d);if(this.wildcard){a:{for(var b=a,b="string"===typeof b?b.split(this.delimiter):b.slice(),c=0,e=b.length;c+1<e;c++)if("**"===b[c]&&"**"===b[c+1])break a;c=this.listenerTree;for(e=b.shift();e;){c[e]||(c[e]={});c=c[e];if(0===b.length){c._listeners?
"function"===typeof c._listeners?c._listeners=[c._listeners,d]:n(c._listeners)&&(c._listeners.push(d),c._listeners.warned||(b=10,"undefined"!==typeof this._events.maxListeners&&(b=this._events.maxListeners),0<b&&c._listeners.length>b&&(c._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",c._listeners.length),console.trace()))):c._listeners=d;break a}e=b.shift()}}return this}this._events[a]?
"function"===typeof this._events[a]?this._events[a]=[this._events[a],d]:n(this._events[a])&&(this._events[a].push(d),this._events[a].warned||(b=10,"undefined"!==typeof this._events.maxListeners&&(b=this._events.maxListeners),0<b&&this._events[a].length>b&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),console.trace()))):this._events[a]=d;return this};
g.prototype.onAny=function(a){if("function"!==typeof a)throw Error("onAny only accepts instances of Function");this._all||(this._all=[]);this._all.push(a);return this};g.prototype.addListener=g.prototype.on;g.prototype.off=function(a,d){if("function"!==typeof d)throw Error("removeListener only takes instances of Function");var b,c=[];if(this.wildcard)b="string"===typeof a?a.split(this.delimiter):a.slice(),c=k.call(this,null,b,this.listenerTree,0);else{if(!this._events[a])return this;b=this._events[a];
c.push({_listeners:b})}for(var e=0;e<c.length;e++){var f=c[e];b=f._listeners;if(n(b)){for(var g=-1,h=0,l=b.length;h<l;h++)if(b[h]===d||b[h].listener&&b[h].listener===d||b[h]._origin&&b[h]._origin===d){g=h;break}if(!(0>g)){this.wildcard?f._listeners.splice(g,1):this._events[a].splice(g,1);0===b.length&&(this.wildcard?delete f._listeners:delete this._events[a]);break}}else if(b===d||b.listener&&b.listener===d||b._origin&&b._origin===d)this.wildcard?delete f._listeners:delete this._events[a]}return this};
g.prototype.offAny=function(a){var d=0,b=0,c;if(a&&this._all&&0<this._all.length)for(c=this._all,d=0,b=c.length;d<b;d++){if(a===c[d]){c.splice(d,1);break}}else this._all=[];return this};g.prototype.removeListener=g.prototype.off;g.prototype.removeAllListeners=function(a){if(0===arguments.length)return!this._events||m.call(this),this;if(this.wildcard)for(var d="string"===typeof a?a.split(this.delimiter):a.slice(),d=k.call(this,null,d,this.listenerTree,0),b=0;b<d.length;b++)d[b]._listeners=null;else{if(!this._events[a])return this;
this._events[a]=null}return this};g.prototype.listeners=function(a){if(this.wildcard){var d=[];a="string"===typeof a?a.split(this.delimiter):a.slice();k.call(this,d,a,this.listenerTree,0);return d}this._events||m.call(this);this._events[a]||(this._events[a]=[]);n(this._events[a])||(this._events[a]=[this._events[a]]);return this._events[a]};g.prototype.listenersAny=function(){return this._all?this._all:[]};"function"===typeof define&&define.amd?define(function(){return g}):"object"===typeof exports?
exports.EventEmitter2=g:window.EventEmitter2=g}();